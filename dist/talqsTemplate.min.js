/**
 * TalqsTemplate v1.0.0
 * (c) 2017 JinJun He
 * @license MIT
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.TalqsTemplate=n()}(this,function(){"use strict";function e(e){return e.replace($,"").replace(b,",").replace(w,"").replace(I,"").replace(x,"").split(z)}function n(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function a(a,t){function i(e){return f+=e.split(/\n/).length-1,u&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=y[1]+n(e)+y[2]+"\n"),e}function l(n){var a=f;if(c?n=c(n,t):s&&(n=n.replace(/\n/g,function(){return f++,"$line="+f+";"})),0===n.indexOf("=")){var i=d&&!/^=[=#]/.test(n);if(n=n.replace(/^=[=#]?|[\s;]*$/g,""),i){var l=n.replace(/\s*\([^\)]+\)/,"");p[l]||/^(include|print)$/.test(l)||(n="$escape("+n+")")}else n="$string("+n+")";n=y[1]+n+y[2]}return s&&(n="$line="+a+";"+n),g(e(n),function(e){if(e&&!m[e]){var n;n="print"===e?b:"include"===e?w:p[e]?"$utils."+e:v[e]?"$helpers."+e:"$data."+e,I+=e+"="+n+",",m[e]=!0}}),n+"\n"}var s=t.debug,r=t.openTag,o=t.closeTag,c=t.parser,u=t.compress,d=t.escape,f=1,m={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},h="".trim,y=h?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],$=h?"$out+=text;return $out;":"$out.push(text);",b="function(){var text=''.concat.apply('',arguments);"+$+"}",w="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+$+"}",I="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(s?"$line=0,":""),x=y[0],z="return new String("+y[3]+");";g(a.split(r),function(e){e=e.split(o);var n=e[0],a=e[1];1===e.length?x+=i(n):(x+=l(n),a&&(x+=i(a)))});var _=I+x+z;s&&(_="try{"+_+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+n(a)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var A=new Function("$data","$filename",_);return A.prototype=p,A}catch(e){throw e.temp="function anonymous($data,$filename) {"+_+"}",e}}var t=function(e,n){return"string"==typeof n?h(n,{filename:e}):s(e,n)};t.version="3.0.0",t.config=function(e,n){i[e]=n};var i=t.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},l=t.cache={};t.render=function(e,n){return h(e)(n)};var s=t.renderFile=function(e,n){var a=t.get(e)||m({filename:e,name:"Render Error",message:"Template not found"});return n?a(n):a};t.get=function(e){var n;if(l[e])n=l[e];else if("object"==typeof document){var a=document.getElementById(e);if(a){var t=(a.value||a.innerHTML).replace(/^\s*|\s*$/g,"");n=h(t,{filename:e})}}return n};var r=function(e,n){return"string"!=typeof e&&(n=typeof e,"number"===n?e+="":e="function"===n?r(e.call(e)):""),e},o={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},c=function(e){return o[e]},u=function(e){return r(e).replace(/&(?![\w#]+;)|[<>"']/g,c)},d=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},f=function(e,n){var a,t;if(d(e))for(a=0,t=e.length;a<t;a++)n.call(e,e[a],a,e);else for(a in e)n.call(e,e[a],a)},p=t.utils={$helpers:{},$include:s,$string:r,$escape:u,$each:f};t.helper=function(e,n){v[e]=n};var v=t.helpers=p.$helpers;t.onerror=function(e){var n="Template Error\n\n";for(var a in e)n+="<"+a+">\n"+e[a]+"\n\n";"object"==typeof console&&console.error(n)};var m=function(e){return t.onerror(e),function(){return"{Template Error}"}},h=t.compile=function(e,n){function t(a){try{return new o(a,r)+""}catch(t){return n.debug?m(t)():(n.debug=!0,h(e,n)(a))}}n=n||{};for(var s in i)void 0===n[s]&&(n[s]=i[s]);var r=n.filename;try{var o=a(e,n)}catch(e){return e.filename=r||"anonymous",e.name="Syntax Error",m(e)}return t.prototype=o.prototype,t.toString=function(){return o.toString()},r&&n.cache&&(l[r]=t),t},g=p.$each,y="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",$=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,b=/[^\w$]+/g,w=new RegExp(["\\b"+y.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),I=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g,z=/^$|,+/;i.openTag="{{",i.closeTag="}}";var _=function(e,n){var a=n.split(":"),t=a.shift(),i=a.join(":")||"";return i&&(i=", "+i),"$helpers."+t+"("+e+i+")"};i.parser=function(e,n){e=e.replace(/^\s/,"");var a=e.split(" "),i=a.shift(),l=a.join(" ");switch(i){case"if":e="if("+l+"){";break;case"else":a="if"===a.shift()?" if("+a.join(" ")+")":"",e="}else"+a+"{";break;case"/if":e="}";break;case"each":var s=a[0]||"$data",r=a[1]||"as",o=a[2]||"$value",c=a[3]||"$index",u=o+","+c;"as"!==r&&(s="[]"),e="$each("+s+",function("+u+"){";break;case"/each":e="});";break;case"echo":e="print("+l+");";break;case"print":case"include":e=i+"("+a.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(l)){var d=!0;0===e.indexOf("#")&&(e=e.substr(1),d=!1);for(var f=0,p=e.split("|"),v=p.length,m=p[f++];f<v;f++)m=_(m,p[f]);e=(d?"=":"=#")+m}else e=t.helpers[i]?"=#"+i+"("+a.join(",")+");":"="+e}return e};var A="question",S="stemsWrapper",q="analyzeWrapper",C="childQSAnalyzeWrapper",L="questionAnswerItem",T="questionAnalyzeItem",k="questionKnowledgePointItem",D={Question:A,StemsWrapper:S,ChildQSAnalyze:C,AnalyzeWrapper:q,Index:"questionIndex",Source:"questionSource",Difficulty:"questionDifficulty",Content:"questionContent",Options:"questionOptions",ChildList:"questionChildList",Answer:"questionAnswer",AnswerItem:L,Analyze:"questionAnalyze",AnalyzeItem:T,KnowledgePoint:"questionKnowledgePoint",KnowledgePointItem:k,QueID:"questionID"},j={};j[A]=[S,q],j[S]=[D.Index,D.Source,D.Difficulty,D.Content,D.Options,D.ChildList,D.ChildQSAnalyze],j[q]=[D.Answer,D.Analyze,D.KnowledgePoint,D.QueID],j[C]=[D.Answer,D.Analyze,D.KnowledgePoint,D.QueID];var P={answer:"答案",analyze:"解析",queId:"ID",knowledgePoint:"知识点",label:"标签"},O={analyzeVersion:0,hideSource:!1,hideDifficulty:!1,templates:j,labels:P,queIndex:0,entryTemplate:A},W={};W.json=function(e){return JSON.stringify(e)},W.formatDifficulty=function(e,n){e=parseInt(e,10)||0;for(var a="",t=0;t<e;t++)a+=n;return a},W.formatAnswer=function(e){var n="";if(Array.isArray(e))for(var a=e.length,t=0;t<a;t++)t%5==0&&t>0&&(n+=" "),n+=e[t];return n};var Q,E="talqs",K=E+"_options",R={main:E,options:K,stems:E+"_main",subqs:E+"_subqs",content:E+"_content",difficulty:E+"_difficulty",index:E+"_index",source:E+"_source",knowledgePoint:E+"_knowledgePoint",id:E+"_id",analyzeItem:E+"_analyze_item",analyzeItemIndex:E+"_analyze_item_index",panelItem:E+"_panel_item",panelItemContent:E+"_panel_item_content",answer:E+"_answer",analyze:E+"_analyze",analyzeGroup:E+"_analyzeGroup",analyzeSingle:E+"analyzeSingle",optionsList:K+"_list",optionsRows:K+"_rows",optionsColumns:K+"_columns",optionsItem:K+"_columns_item",optionsIndex:K+"_index",optionsLabel:K+"_label",optionsContent:K+"_content",label:E+"_label",panel:E+"_panel",tree:E+"_tree",clear:"clearfix"},V='<div class="'+R.main+"\">\n  {{ each config.templates['"+A+"'] }}\n    {{include $value}}\n  {{/each}}\n</div>\n",G='\n<div class="'+R.stems+"\">\n {{each config.templates['"+S+"']}}\n    {{include $value}}\n {{/each}}\n</div>\n",F='\n  {{if config.analyzeVersion === 2}}\n     <div class="'+R.analyzeGroup+"\">\n      {{ each config.templates['"+q+"'] }}\n        {{include $value}}\n      {{/each}}\n    </div>\n  {{/if}}\n",H='\n{{if index && index > 0}}\n  <span class="'+R.index+'">\n    {{index}}\n  </span>\n{{/if}}\n',B='\n{{if !isSub && !config.hideSource}}\n  <div class="'+R.source+'">\n    {{data.queSource}}\n  </div>\n{{/if}}\n',J='\n{{if data.content && !data.hideContent}}\n  <div class="'+R.content+" "+R.clear+'">{{#data.content}}</div>\n{{/if}}\n',M='\n{{ if data.answerOptionList }}\n  <div class="'+R.options+'">\n    <ul class="'+R.optionsList+'">\n      {{each data.answerOptionList }}\n        <li class="'+R.optionsRows+'">\n          {{if data.isCloze }}\n            <span class="'+R.optionsIndex+'">{{$index+1}}. </span>\n          {{/if}}\n          <ul class="'+R.optionsColumns+"_{{$value.length}} "+R.clear+'">\n            {{each $value}}\n              <li class="'+R.optionsItem+" "+R.clear+'">\n                <span class="'+R.optionsLabel+'">{{$value.aoVal}}. </span>\n                <div class="'+R.optionsContent+'">{{#$value.content}}</div>\n              </li>\n            {{/each}}\n          </ul>\n        </li>\n      {{/each}}\n    </ul>\n  </div>\n{{/if}}\n',N="<span>&#9733;</span>",U='\n{{if !isSub && !config.hideDifficulty}}\n  <div class="'+R.difficulty+"\">\n    {{#data.difficulty | formatDifficulty:'"+N+"'}}\n  </div>\n{{/if}}\n",X="{data:$value,config:config,index:$index+1,isSub:true}",Y='\n{{ if data.childList }}\n  <div class="'+R.subqs+"\">\n    {{each data.childList}}\n      {{include '"+S+"' "+X+" ''}}\n    {{/each}}\n  </div>\n{{/if}}\n",Z='\n{{if isSub && config.analyzeVersion === 1 && !data.childList }}\n   <div class="'+R.analyzeSingle+"\">\n    {{ each config.templates['"+C+"'] }}\n      {{include $value}}\n    {{/each}}\n  </div>\n{{/if}}\n",ee='\n<div class="'+R.answer+"  "+R.clear+'">\n  <label class="'+R.label+'">\n    {{config.labels.answer}}\n  </label>\n  <div class="'+R.panel+"\">\n    {{include '"+L+"'}}\n  </div>\n</div>\n",ne='\n{{if data.childList}}\n  {{each data.childList}}\n    <div class="'+R.analyzeItem+'">\n      <div class="'+R.analyzeItemIndex+"\">{{$index+1}}</div>\n      {{include '"+L+"' {data:$value} ''}}\n    </div>\n  {{/each}}\n{{else}}\n  <div class=\""+R.panelItem+'">\n    <div class="'+R.panelItemContent+"\">\n        {{if data.isCloze}}\n          {{data.answer | formatAnswer}}\n        {{else}}\n          {{#data.answer.join(' ')}}\n        {{/if}}\n    </div>\n  </div>\n{{/if}}\n",ae='\n<div class="'+R.analyze+"  "+R.clear+'">\n  <label class="'+R.label+'">\n    {{config.labels.analyze}}\n  </label>\n  <div class="'+R.panel+"\">\n    {{include '"+T+"'}}\n  </div>\n</div>\n",te='\n{{if data.childList}}\n  {{each data.childList}}\n    <div class="'+R.analyzeItem+'">\n      <div class="'+R.analyzeItemIndex+"\">{{$index+1}}</div>\n      {{include '"+T+"' {data:$value} ''}}\n    </div>\n  {{/each}}\n{{else}}\n  <div class=\""+R.panelItem+'">\n    <div class="{style.panelItemContent}">{{#data.analysis}}</div>\n  </div>\n{{/if}}\n',ie='\n <div class="'+R.knowledgePoint+"  "+R.clear+'">\n  <label class="'+R.label+'">\n    {{config.labels.knowledgePoint}}\n  </label>\n  <div class="'+R.tree+"\">\n    <ul>\n      {{each data.examOptionList}}\n        {{include '"+k+"' {data:$value} ''}}\n      {{/each}}\n    </ul>\n  </div>\n</div>\n",le="\n<li>\n  {{data.name}}\n  {{if data.childList}}\n    <ul>\n      {{each data.childList}}\n        {{include '"+k+"' {data:$value} ''}}\n      {{/each}}\n    </ul>\n  {{/if}}\n</li>\n",se='\n<div class="'+R.id+"  "+R.clear+'">\n  <label class="'+R.label+'">\n    {{config.labels.queId}}\n  </label>\n  <div class="'+R.panel+'">\n    {{data.queId}}  \n  </div>\n</div>\n',re=(Q={},Q[D.Question]=V,Q[D.StemsWrapper]=G,Q[D.AnalyzeWrapper]=F,Q[D.ChildQSAnalyze]=Z,Q[D.Index]=H,Q[D.Source]=B,Q[D.Content]=J,Q[D.Options]=M,Q[D.Difficulty]=U,Q[D.ChildList]=Y,Q[D.Answer]=ee,Q[D.AnswerItem]=ne,Q[D.Analyze]=ae,Q[D.AnalyzeItem]=te,Q[D.KnowledgePoint]=ie,Q[D.KnowledgePointItem]=le,Q[D.QueID]=se,Q),oe={version:"1.0.0",config:O};oe.render=function(e,n){if(e){n=n||{};for(var a in O)void 0===n[a]&&(n[a]=O[a]);oe.config=n;var i=t.cache[n.entryTemplate],l=i({config:n,data:e,index:n.queIndex});return l}};var ce=function(e,n){t.helper(e,n)};oe.registerHelper=ce;for(var ue in W)ce(ue,W[ue]);var de=function(e){for(var n in e){var a=e[n].replace(/^\s*|\s*$/g,""),i=t.compile(a,{filename:n});t.cache[n]=i}};return de(re),oe.registerComponent=de,oe.registerTemplate=function(e,n){oe.config.templates[e]=n},oe.updateTemplateList=function(e,n){var a,t,i=oe.config.templates[e]||[];n.forEach(function(e,n){t=e.component,t&&(a=i.indexOf(t),e.remove&&a>=0&&i.splice(a,1),a<0&&!e.remove&&(a=void 0!==e.index&&e.index<i.length?e.index:i.length,i.splice(a,0,t)))}),oe.config.templates[e]=i},oe});